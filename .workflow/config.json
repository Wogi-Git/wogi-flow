{
  "$schema": "./config.schema.json",
  "version": "2.0.0",
  "projectName": "wogi-flow",
  "autoLog": true,
  "autoUpdateAppMap": true,
  "requireApproval": [],
  "enforcement": {
    "strictMode": true,
    "requireTaskForImplementation": true,
    "requireStoryForMediumTasks": true,
    "requirePatternCitation": false,
    "citationFormat": "// Pattern: {pattern}",
    "taskSizeThresholds": {
      "small": {
        "maxFiles": 3,
        "maxHours": 1
      },
      "medium": {
        "maxFiles": 10,
        "maxHours": 4
      },
      "large": {
        "minFiles": 10,
        "minHours": 4
      }
    }
  },
  "workflow": {
    "planningStyle": "feature-based",
    "agentStructure": "unified"
  },
  "loops": {
    "enabled": true,
    "enforced": true,
    "blockExitUntilComplete": true,
    "requireVerification": true,
    "blockOnSkip": true,
    "maxRetries": 5,
    "maxIterations": 20,
    "commitEvery": 3,
    "pauseBetweenScenarios": false,
    "autoInferVerification": true,
    "fallbackToManual": true,
    "suggestBrowserTests": true,
    "simpleMode": {
      "enabled": true,
      "completionPromise": "TASK_COMPLETE",
      "maxIterations": 10
    },
    "recheckAllAfterFix": true,
    "regressionOnRecheck": "warn"
  },
  "taskQueue": {
    "enabled": true,
    "autoContinue": true,
    "pauseBetweenTasks": false,
    "maxQueueSize": 10,
    "showProgressSummary": true
  },
  "durableSteps": {
    "enabled": true,
    "autoResume": true,
    "checkSuspensionsOnStart": true,
    "defaultMaxAttempts": 5
  },
  "suspension": {
    "enabled": true,
    "pollIntervalSeconds": 60,
    "maxPollAttempts": 120,
    "reminderAfterHours": 24
  },
  "parallel": {
    "enabled": true,
    "maxConcurrent": 3,
    "autoApprove": false,
    "requireWorktree": true,
    "showProgress": true,
    "autoDetect": true,
    "autoSuggest": true,
    "autoExecute": false,
    "minTasksForParallel": 2
  },
  "phases": {
    "enabled": false,
    "definitions": []
  },
  "mandatorySteps": {
    "afterTask": [],
    "beforeCommit": [],
    "onSessionEnd": [
      "updateRequestLog",
      "updateAppMap"
    ]
  },
  "priorities": {
    "defaultPriority": "P2",
    "autoBoostDays": 2,
    "autoBoostAmount": 1,
    "levels": {
      "P0": {
        "label": "Critical",
        "description": "Drop everything"
      },
      "P1": {
        "label": "High",
        "description": "Do today"
      },
      "P2": {
        "label": "Medium",
        "description": "Do this week"
      },
      "P3": {
        "label": "Low",
        "description": "Do when possible"
      },
      "P4": {
        "label": "Backlog",
        "description": "Someday"
      }
    }
  },
  "storyDecomposition": {
    "autoDetect": true,
    "autoDecompose": false,
    "complexityThreshold": "medium",
    "minSubTasks": 5,
    "edgeCases": true,
    "loadingStates": true,
    "errorStates": true
  },
  "specificationMode": {
    "enabled": true,
    "mandatory": true,
    "mandatoryFor": ["medium", "large"],
    "skipFor": ["small", "bugfix"],
    "requireApproval": true,
    "specDirectory": ".workflow/specs",
    "template": "default",
    "sections": {
      "acceptanceCriteria": true,
      "implementationSteps": true,
      "filesToChange": true,
      "testStrategy": true,
      "verificationCommands": true,
      "rollbackPlan": false
    },
    "autoDetectFiles": true,
    "autoSuggestTests": true
  },
  "qualityGates": {
    "feature": {
      "require": [
        "loopComplete",
        "tests",
        "appMapUpdate",
        "requestLogEntry"
      ],
      "optional": [
        "review",
        "docs"
      ]
    },
    "bugfix": {
      "require": [
        "loopComplete",
        "tests",
        "requestLogEntry"
      ],
      "optional": [
        "review"
      ]
    },
    "refactor": {
      "require": [
        "loopComplete",
        "tests",
        "noNewFeatures"
      ],
      "optional": [
        "review"
      ]
    }
  },
  "validation": {
    "afterFileEdit": {
      "enabled": false,
      "commands": {
        "*.ts": [
          "npx tsc --noEmit"
        ],
        "*.tsx": [
          "npx tsc --noEmit",
          "npx eslint {file} --fix"
        ],
        "*.js": [
          "npx eslint {file} --fix"
        ],
        "*.jsx": [
          "npx eslint {file} --fix"
        ]
      },
      "fixErrorsBeforeContinuing": true
    },
    "afterTaskComplete": {
      "enabled": true,
      "commands": [
        "npm run lint",
        "npm run typecheck"
      ]
    },
    "beforeCommit": {
      "enabled": true,
      "commands": [
        "npm run lint",
        "npm run typecheck",
        "npm run test"
      ]
    }
  },
  "testing": {
    "runAfterTask": false,
    "runBeforeCommit": false
  },
  "regressionTesting": {
    "enabled": true,
    "sampleSize": 3,
    "runOnTaskComplete": true,
    "onFailure": "warn"
  },
  "browserTesting": {
    "enabled": true,
    "runOnTaskComplete": true,
    "runForUITasks": true,
    "autoRun": false,
    "timeout": 30000,
    "screenshotOnFailure": true,
    "baseUrl": "http://localhost:3000"
  },
  "componentRules": {
    "preferVariants": true,
    "requireAppMapEntry": true,
    "requireDetailDoc": false,
    "autoGenerateStorybook": false,
    "storybookPath": "src/stories"
  },
  "strictMode": {
    "verificationChecklist": false,
    "correctionReportsOnFail": false,
    "featureReportsOnComplete": false
  },
  "skills": {
    "installed": [
      "nestjs",
      "figma-analyzer",
      "transcript-digestion"
    ],
    "comingSoon": [
      "react",
      "python"
    ],
    "autoInvoke": true,
    "maxSkillsPerTask": 3,
    "loadPatterns": true,
    "loadAntiPatterns": true,
    "loadLearnings": true
  },
  "skillLearning": {
    "enabled": true,
    "autoExtract": true,
    "triggers": {
      "onCommit": true,
      "onTaskComplete": true,
      "onCompact": true
    },
    "minCorrectionsToLearn": 1,
    "autoCreateSkills": "ask",
    "autoDetectFrameworks": true,
    "fetchOfficialDocs": true,
    "frameworkDetectionPatterns": {
      "nestjs": [
        "*.module.ts",
        "*.controller.ts",
        "*.service.ts",
        "@nestjs/*"
      ],
      "react": [
        "*.tsx",
        "*.jsx",
        "use*.ts",
        "react",
        "react-dom"
      ],
      "vue": [
        "*.vue",
        "vue",
        "@vue/*"
      ],
      "angular": [
        "*.component.ts",
        "*.module.ts",
        "@angular/*"
      ],
      "fastapi": [
        "main.py",
        "fastapi",
        "pydantic"
      ],
      "django": [
        "manage.py",
        "django",
        "settings.py"
      ],
      "express": [
        "app.js",
        "express",
        "router.js"
      ]
    },
    "officialDocsUrls": {
      "nestjs": "https://docs.nestjs.com",
      "react": "https://react.dev",
      "vue": "https://vuejs.org/guide",
      "angular": "https://angular.io/docs",
      "fastapi": "https://fastapi.tiangolo.com",
      "django": "https://docs.djangoproject.com",
      "express": "https://expressjs.com/en/guide"
    },
    "learnFromLoopRetries": true,
    "loopRetryThreshold": 3,
    "autoSuggestPatternUpdates": true
  },
  "memory": {
    "enabled": true,
    "localDb": ".workflow/memory/local.db",
    "embeddingModel": "Xenova/all-MiniLM-L6-v2",
    "maxLocalFacts": 1000,
    "autoRemember": false
  },
  "automaticMemory": {
    "enabled": true,
    "entropyThreshold": 0.7,
    "compactOnSessionEnd": true,
    "relevanceDecay": {
      "enabled": true,
      "decayRate": 0.033,
      "neverAccessedPenalty": 0.1
    },
    "demotion": {
      "relevanceThreshold": 0.3,
      "coldRetentionDays": 90
    },
    "selfTuning": {
      "enabled": false,
      "adjustOnOverflow": true,
      "adjustOnFailures": true
    }
  },
  "automaticPromotion": {
    "enabled": true,
    "threshold": 3,
    "minRelevance": 0.8,
    "destinations": [
      "decisions.md"
    ],
    "requireApproval": true,
    "autoApplyTeamApproved": true
  },
  "knowledgeRouting": {
    "autoDetect": true,
    "confirmWithUser": true,
    "defaultScope": "local",
    "modelSpecificLearning": true
  },
  "modelAdapters": {
    "enabled": true,
    "autoLearn": true,
    "directory": ".workflow/model-adapters"
  },
  "prd": {
    "enabled": true,
    "maxContextTokens": 2000,
    "chunkSize": 500,
    "autoRetrieve": false
  },
  "autoContext": {
    "enabled": true,
    "showLoadedFiles": true,
    "maxFilesToLoad": 10,
    "maxGrepResults": 10,
    "maxComponentMatches": 15,
    "maxContentLines": 50,
    "includeContent": false,
    "useAstGrep": false,
    "maxSemanticFacts": 5,
    "semanticMinRelevance": 40,
    "lspEnrichment": {
      "enabled": true,
      "maxFiles": 5,
      "timeoutMs": 2000,
      "showExports": true,
      "showDiagnostics": true,
      "prioritizeHealthyFiles": true
    }
  },
  "sessionState": {
    "enabled": true,
    "autoRestore": true,
    "maxGapHours": 24,
    "trackFiles": true,
    "trackDecisions": true,
    "maxRecentFiles": 20,
    "maxRecentDecisions": 10
  },
  "contextMonitor": {
    "enabled": true,
    "warnAt": 0.7,
    "criticalAt": 0.85,
    "contextWindow": 200000,
    "checkOnSessionStart": true,
    "checkAfterTask": true
  },
  "morningBriefing": {
    "enabled": true,
    "showLastSession": true,
    "showChanges": true,
    "showRecommendedTasks": 3,
    "generatePrompt": true,
    "showBlockers": true,
    "showKeyContext": true
  },
  "requestLog": {
    "enabled": true,
    "autoArchive": true,
    "maxRecentEntries": 50,
    "keepRecent": 30,
    "createSummary": true
  },
  "componentIndex": {
    "autoScan": true,
    "scanOn": [
      "sessionStart",
      "afterTask",
      "preCommit"
    ],
    "staleAfterMinutes": 60,
    "directories": [
      "src/components",
      "src/hooks",
      "src/services",
      "src/pages",
      "src/modules",
      "app"
    ],
    "ignore": [
      "*.test.*",
      "*.spec.*",
      "*.stories.*",
      "index.ts",
      "index.js",
      "__tests__",
      "__mocks__"
    ]
  },
  "figmaAnalyzer": {
    "enabled": true,
    "thresholds": {
      "exactMatch": 95,
      "strongMatch": 80,
      "variantCandidate": 60
    },
    "componentDirs": [
      "src/components",
      "components",
      "src/ui",
      "ui"
    ],
    "mcpServer": {
      "port": 3847,
      "autoStart": false
    },
    "autoScanOnAnalyze": true,
    "generatePrompts": true
  },
  "guidedEdit": {
    "enabled": true,
    "sessionFile": ".workflow/state/guided-edit-session.json",
    "extensions": [
      "ts",
      "tsx",
      "js",
      "jsx",
      "vue",
      "svelte"
    ],
    "srcDir": null
  },
  "traces": {
    "saveTo": ".workflow/traces",
    "generateDiagrams": true
  },
  "worktree": {
    "enabled": false,
    "autoCleanupHours": 24,
    "keepOnFailure": false,
    "squashOnMerge": true
  },
  "hybrid": {
    "enabled": false,
    "executor": {
      "type": "local",
      "provider": null,
      "providerEndpoint": null,
      "model": null,
      "apiKey": null
    },
    "planner": {
      "adaptToExecutor": true,
      "useAdapterKnowledge": true
    },
    "provider": null,
    "providerEndpoint": null,
    "model": null,
    "settings": {
      "temperature": 0.7,
      "maxTokens": 4096,
      "maxRetries": 20,
      "timeout": 120000,
      "autoExecute": false,
      "createBranch": false,
      "tokenEstimation": {
        "enabled": true,
        "minTokens": 1000,
        "maxTokens": 8000,
        "defaultLevel": "medium",
        "logMetrics": true
      }
    },
    "cloudProviders": {
      "openai": {
        "models": [
          "gpt-4o-mini",
          "gpt-4o"
        ],
        "defaultModel": "gpt-4o-mini",
        "envKey": "OPENAI_API_KEY"
      },
      "anthropic": {
        "models": [
          "claude-3-5-haiku-latest",
          "claude-3-haiku-20240307"
        ],
        "defaultModel": "claude-3-5-haiku-latest",
        "envKey": "ANTHROPIC_API_KEY"
      },
      "google": {
        "models": [
          "gemini-2.0-flash-exp",
          "gemini-1.5-flash"
        ],
        "defaultModel": "gemini-2.0-flash-exp",
        "envKey": "GOOGLE_API_KEY"
      }
    },
    "templates": {
      "directory": "templates/hybrid"
    },
    "projectContext": {
      "uiFramework": null,
      "stylingApproach": null,
      "componentDirs": [],
      "typeDirs": [
        "src/types/*.ts"
      ],
      "availableComponents": {},
      "typeLocations": {},
      "doNotImport": [
        "React"
      ],
      "excludeTypePatterns": [],
      "excludeDirectories": [
        "__tests__",
        "__mocks__",
        "node_modules",
        ".git",
        "dist",
        "build"
      ],
      "projectWarnings": [],
      "customRules": []
    }
  },
  "voice": {
    "enabled": false,
    "provider": null,
    "openaiApiKey": null,
    "groqApiKey": null,
    "localModelPath": "base.en",
    "defaultDuration": 30,
    "sampleRate": 16000,
    "channels": 1
  },
  "transcriptDigestion": {
    "enabled": true,
    "autoTriggerThreshold": 2000,
    "autoTriggerTypes": ["transcript", "specs", "requirements", "feature-request"],
    "clarificationStyle": "grouped",
    "verificationLevel": "statement",
    "storyPresentation": "user-controlled",
    "autoResolveContradictions": true,
    "showSourceStatements": true,
    "voiceClarification": true,
    "supportedLanguages": ["en", "uk", "ru", "he"],
    "chunkingThreshold": 10000,
    "chunkSize": 5000,
    "chunkOverlap": 500,
    "outputLanguage": "en",
    "adaptiveComplexity": {
      "enabled": true,
      "smallThreshold": { "topics": 3, "statements": 10 },
      "mediumThreshold": { "topics": 8, "statements": 30 }
    }
  },
  "lsp": {
    "enabled": true,
    "server": "typescript-language-server",
    "timeout": 5000,
    "cacheTypes": true
  },
  "codebaseInsights": {
    "enabled": true,
    "generateOn": [
      "onboarding",
      "manual"
    ]
  },
  "commits": {
    "requireApproval": {
      "feature": true,
      "bugfix": false,
      "refactor": true,
      "docs": false
    },
    "autoCommitSmallFixes": true,
    "smallFixThreshold": 3,
    "squashTaskCommits": true,
    "commitMessageFormat": "conventional"
  },
  "export": {
    "defaultFlags": ["--rules"],
    "sanitizeTemplates": true,
    "includeSkillLearnings": true,
    "excludePatterns": ["*.local.*", "*.secret.*", ".env*"]
  },
  "security": {
    "scanBeforeCommit": true,
    "blockOnHigh": true,
    "checkPatterns": {
      "secrets": true,
      "injection": true,
      "npmAudit": true
    },
    "ignoreFiles": [
      "*.test.ts",
      "*.spec.ts"
    ]
  },
  "damageControl": {
    "enabled": false,
    "patternsFile": ".workflow/damage-control.yaml",
    "events": {
      "bash": true,
      "file": true,
      "stop": true,
      "prompt": false
    },
    "promptHook": {
      "enabled": false,
      "model": "haiku",
      "timeout": 5000,
      "skipSafeCommands": true
    },
    "onBlock": "error",
    "onAsk": "prompt",
    "logging": true
  },
  "team": {
    "enabled": false,
    "teamId": null,
    "userId": null,
    "setupId": null,
    "projectId": null,
    "apiKey": null,
    "backendUrl": "https://api.wogi-flow.com",
    "syncInterval": 300000,
    "autoSync": true,
    "projectScope": true,
    "sync": {
      "decisions": true,
      "appMap": true,
      "componentIndex": true,
      "skills": true,
      "memory": true,
      "requestLog": "recent",
      "tasks": false
    },
    "conflictResolution": "newest-wins",
    "aws": {
      "apiEndpoint": "https://slbche87zj.execute-api.eu-west-1.amazonaws.com/v1",
      "cognitoUserPool": "eu-west-1_RnQtfENnx",
      "cognitoClientId": "3fb5530dnciblc1acdkkih2gq8",
      "region": "eu-west-1"
    }
  },
  "agents": {
    "enabled": [
      "orchestrator",
      "story-writer",
      "developer",
      "reviewer",
      "tester"
    ],
    "optional": [
      "accessibility",
      "security",
      "performance",
      "docs",
      "design-system",
      "onboarding"
    ]
  },
  "multiApproach": {
    "enabled": true,
    "mode": "suggest",
    "triggerOn": [
      "large",
      "xl"
    ],
    "maxApproaches": 3,
    "selectionStrategy": "first-passing"
  },
  "hooks": {
    "enabled": true,
    "targets": [
      "claude-code"
    ],
    "gracefulDegradation": true,
    "timeout": 5000,
    "rules": {
      "taskGating": {
        "enabled": true,
        "blockWithoutTask": true
      },
      "validation": {
        "enabled": true,
        "runAfterEdit": true
      },
      "loopEnforcement": {
        "enabled": true
      },
      "componentReuse": {
        "enabled": true,
        "threshold": 80,
        "blockOnSimilar": false
      },
      "sessionContext": {
        "enabled": true,
        "loadSuspendedTasks": true,
        "loadDecisions": true,
        "loadRecentActivity": true
      },
      "autoLogging": {
        "enabled": true
      }
    },
    "claudeCode": {
      "installPath": ".claude/settings.local.json"
    },
    "gemini": {},
    "codex": {}
  },
  "metrics": {
    "enabled": true,
    "trackCommands": true,
    "retentionDays": 30,
    "alertOnFailureRate": 0.3
  },
  "corrections": {
    "mode": "inline",
    "detailPath": ".workflow/corrections"
  },
  "workflowSteps": {
    "regressionTest": {
      "enabled": true,
      "mode": "warn",
      "when": "afterTask"
    },
    "browserTest": {
      "enabled": true,
      "mode": "prompt",
      "when": "afterTask",
      "triggerFor": [
        "*.tsx",
        "*.jsx",
        "*.vue"
      ]
    },
    "securityScan": {
      "enabled": true,
      "mode": "block",
      "when": "beforeCommit",
      "config": {
        "severity": "high"
      }
    },
    "updateKnowledgeBase": {
      "enabled": false,
      "mode": "prompt",
      "when": "afterTask"
    },
    "updateChangelog": {
      "enabled": false,
      "mode": "prompt",
      "when": "beforeCommit"
    },
    "codeComplexityCheck": {
      "enabled": false,
      "mode": "warn",
      "when": "afterTask",
      "config": {
        "threshold": 10
      }
    },
    "coverageCheck": {
      "enabled": false,
      "mode": "warn",
      "when": "beforeCommit",
      "config": {
        "minCoverage": 80
      }
    },
    "codeSimplifier": {
      "enabled": false,
      "mode": "prompt",
      "when": "afterTask",
      "config": {
        "maxFunctionLines": 50,
        "maxNestingDepth": 3,
        "suggestExtraction": true
      }
    },
    "codeReview": {
      "enabled": false,
      "mode": "warn",
      "when": "afterTask",
      "config": {
        "multiAgentThreshold": 5,
        "highRiskPatterns": ["auth", "payment", "security", "crypto"],
        "confidenceThreshold": 80
      }
    },
    "prTestAnalyzer": {
      "enabled": true,
      "mode": "warn",
      "when": "beforeCommit",
      "config": {
        "checkCoverage": true,
        "checkQuality": true,
        "minCoverageForModified": 70
      }
    },
    "silentFailureHunter": {
      "enabled": false,
      "mode": "warn",
      "when": "afterTask",
      "config": {
        "checkEmptyCatch": true,
        "checkLogOnlyCatch": true,
        "checkUnhandledAsync": true,
        "checkPromiseChains": true
      }
    },
    "commentAnalyzer": {
      "enabled": false,
      "mode": "warn",
      "when": "afterTask",
      "config": {
        "flagTodo": true,
        "flagFixme": true,
        "checkJsdoc": true,
        "flagCommentedCode": true,
        "flagStale": true
      }
    }
  }
}